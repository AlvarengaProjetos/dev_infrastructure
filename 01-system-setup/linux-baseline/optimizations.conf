# =============================================================================
# Network Buffer Specific Optimizations
# Socket and TCP/UDP buffer configurations for high-throughput networking
# =============================================================================

# -----------------------------------------------------------------------------
# CORE SOCKET BUFFERS
# -----------------------------------------------------------------------------

# Maximum socket buffer sizes (16MB each)
net.core.rmem_max = 16777216    # 16MB max receive buffer
net.core.wmem_max = 16777216    # 16MB max send buffer

# Default socket buffer sizes
net.core.rmem_default = 262144  # 256KB default receive
net.core.wmem_default = 262144  # 256KB default send

# Optional memory allocation
net.core.optmem_max = 65536     # 64KB per-socket optional buffer

# -----------------------------------------------------------------------------
# TCP BUFFER SETTINGS
# -----------------------------------------------------------------------------

# TCP read buffer: min=4KB, default=64KB, max=16MB
net.ipv4.tcp_rmem = 4096 65536 16777216

# TCP write buffer: min=4KB, default=64KB, max=16MB  
net.ipv4.tcp_wmem = 4096 65536 16777216

# TCP memory limits (automatic tuning)
net.ipv4.tcp_mem = 786432 1048576 1572864

# -----------------------------------------------------------------------------
# UDP BUFFER SETTINGS
# -----------------------------------------------------------------------------

# UDP memory: min=4KB, default=85KB, max=16MB
net.ipv4.udp_mem = 4096 87380 16777216

# Minimum UDP buffer sizes
net.ipv4.udp_rmem_min = 16384   # 16KB min UDP receive
net.ipv4.udp_wmem_min = 32768   # 32KB min UDP send

# -----------------------------------------------------------------------------
# QUEUE BUFFERS
# -----------------------------------------------------------------------------

# Network device backlog queue
net.core.netdev_max_backlog = 10000

# Socket connection backlog
net.core.somaxconn = 32768

# TCP SYN backlog queue
net.ipv4.tcp_max_syn_backlog = 4096